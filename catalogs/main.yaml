# catalog.yaml - Download Source Definitions
#
# Parameterized Variables:
# Sources can use {{os}} and {{arch}} placeholders in their params.
#
# Available Variables:
#   {{os}}            - "linux", "macos", "windows"
#   {{os_short}}      - "mac" for macos, matching the OS otherwise
#   {{os_proper}}     - "Linux", "macOS"
#   {{os_melon}}      - "appimage" (linux), "macOS" (macos)
#   {{os_mgba}}       - "appimage" (linux), "macos" (macos)
#   {{arch}}          - "amd64", "arm64"
#   {{arch_fedora}}   - Maps amd64 -> x86_64, arm64 -> aarch64
#   {{arch_electron}} - Maps amd64 -> x64, arm64 -> arm64
#   {{arch_vlc}}      - Maps amd64 -> intel64
#   {{arch_melon}}    - Maps macos -> universal, linux -> x86_64/aarch64
#   {{arch_mgba}}     - Maps macos -> (empty), linux -> -x64/-arm64
#   {{ext}}           - Generic extension: "zip" for linux, "dmg" for macos
#
sources:
  # --- Games ---
  - id: "melonds"
    name: "melonDS"
    strategy: "github_release"
    params:
      repo: "melonDS-emu/melonDS"
      # melonDS-1.1-appimage-x86_64.zip
      # melonDS-1.1-win-x64.zip
      force_os_display: "true"
      asset_pattern: "melonDS-.*-{{os_melon}}-{{arch_melon}}.*"
    exclude: ["macos"]

  - id: "melonds-macos"
    name: "melonDS"
    strategy: "github_release"
    params:
      repo: "melonDS-emu/melonDS"
      # melonDS-1.1-macOS-universal.zip
      force_os_display: "true"
      asset_pattern: "melonDS-.*-macOS-universal.zip"
      arch_override: "universal"
    exclude: ["linux", "windows"]

  - id: "mgba"
    name: "mGBA"
    strategy: "github_release"
    params:
      repo: "mgba-emu/mgba"
      # mGBA-0.10.3-macos.dmg
      # mGBA-0.10.3-appimage-x64.appimage
      # mGBA-0.10.3-win64.7z
      asset_pattern: "mGBA-.*-{{os_mgba}}{{arch_mgba}}.*"
    exclude: ["windows/arm64"]

  # --- Media ---
  - id: "vlc"
    name: "VLC Media Player"
    strategy: "web_scrape"
    params:
      base_url: "https://get.videolan.org/vlc/"
      version_pattern: '(\d+\.\d+\.\d+)/'
      # Construct: 3.0.21/macosx/vlc-3.0.21-intel64.dmg
      # Construct: 3.0.21/win64/vlc-3.0.21-win64.exe
      file_template: "{{version}}/{{os_vlc}}/vlc-{{version}}-{{arch_vlc}}.{{ext}}"
      force_os_display: "true"
    exclude: ["linux"] # Linux VLC is usually via package manager, scraping source is messy

  - id: "jellyfin-player"
    name: "Jellyfin Media Player"
    strategy: "github_release"
    params:
      repo: "jellyfin/jellyfin-media-player"
      # JellyfinMediaPlayer-1.12.0-AppleSilicon.dmg
      # JellyfinMediaPlayer-1.12.0-Intel.dmg
      # JellyfinMediaPlayer-1.12.0-windows-x64.exe
      asset_pattern: "JellyfinMediaPlayer-.*-{{arch_jellyfin}}\\.{{ext}}"
      force_os_display: "true"
    exclude: ["linux", "windows/arm64"] # Only .deb packages available for Linux
